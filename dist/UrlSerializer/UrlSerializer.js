"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UrlSerializer=void 0;const Base_1=require("../Base"),utils_1=require("./utils");class UrlSerializer{_path;_params;_options;constructor(i,t=utils_1.defaultSerializeOptions,s={}){this._path=i,this._params=s,this._options=t,this.extend=this.extend.bind(this),this.setupParam=this.setupParam.bind(this),this.path=this.path.bind(this),this.param=this.param.bind(this),this.build=this.build.bind(this),this.link=this.link.bind(this),this.queries=this.queries.bind(this)}setupParam(i){if((0,Base_1.$Object)(this._params).get(i))throw new utils_1.UniqueParamException(i);this._params={...this._params,[":"+i]:i}}extend(i=void 0,t){return void 0===i&&"build"===t?new UrlSerializer(this._path,this._options,this._params):i&&"queries"===t||i&&"link"===t?new UrlSerializer(i,this._options,this._params):void 0}path(i){return this._path=this._path+"/"+i,this}param(i){return this.setupParam(i),this._path=this._path+"/:"+i,this}link(i){const t=(0,Base_1.$String)(this._path).replaceAll("/",i);return{path:t,extend:()=>this.extend(t,"link")}}queries(i,t){const s=(0,Base_1.$String)(this._path).joinQueryString((0,Base_1.$Object)(i).toQueries({...this._options,...t}));return{path:s,extend:()=>this.extend(s,"queries")}}build(){return{path:this._path,extend:()=>this.extend(void 0,"build"),link:this.link,queries:this.queries}}}exports.UrlSerializer=UrlSerializer;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVybFNlcmlhbGl6ZXIvVXJsU2VyaWFsaXplci5qcyIsIi4uL3NyYy9VcmxTZXJpYWxpemVyL1VybFNlcmlhbGl6ZXIudHMiXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJCYXNlXzEiLCJyZXF1aXJlIiwidXRpbHNfMSIsIlVybFNlcmlhbGl6ZXIiLCJfcGF0aCIsIl9wYXJhbXMiLCJfb3B0aW9ucyIsImNvbnN0cnVjdG9yIiwicGF0aCIsIm9wdGlvbnMiLCJkZWZhdWx0U2VyaWFsaXplT3B0aW9ucyIsInBhcmFtcyIsInRoaXMiLCJleHRlbmQiLCJiaW5kIiwic2V0dXBQYXJhbSIsInBhcmFtIiwiYnVpbGQiLCJsaW5rIiwicXVlcmllcyIsImtleSIsIiRPYmplY3QiLCJnZXQiLCJVbmlxdWVQYXJhbUV4Y2VwdGlvbiIsInVuZGVmaW5lZCIsInR5cGUiLCIkU3RyaW5nIiwicmVwbGFjZUFsbCIsInF1ZXJpZXNPYmplY3QiLCJqb2luUXVlcnlTdHJpbmciLCJ0b1F1ZXJpZXMiXSwibWFwcGluZ3MiOiJBQUFBLGFBQ0FBLE9BQU9DLGVBQWVDLFFBQVMsYUFBYyxDQUFFQyxNQUFPLENBQUEsQ0FBSyxDQUFDLEVBQTVESCxRQUFPQyxjQUFlQyxLQUFBQSxFQ0R0QixNQUFBRSxPQUFBQyxRQUFBLFNBQUEsRUFDQUMsUUFBQUQsUUFBQSxTQUFBLFFBUU1FLGNBSU1DLE1BQ0FDLFFBQ0FDLFNBQ1JDLFlBQ0lDLEVBQ0FDLEVBQXlDUCxRQUFBUSx3QkFDekNDLEVBQWlCLElBRWpCQyxLQUFLUixNQUFRSSxFQUNiSSxLQUFLUCxRQUFVTSxFQUNmQyxLQUFLTixTQUFXRyxFQUNoQkcsS0FBS0MsT0FBU0QsS0FBS0MsT0FBT0MsS0FBS0YsSUFBSSxFQUNuQ0EsS0FBS0csV0FBYUgsS0FBS0csV0FBV0QsS0FBS0YsSUFBSSxFQUMzQ0EsS0FBS0osS0FBT0ksS0FBS0osS0FBS00sS0FBS0YsSUFBSSxFQUMvQkEsS0FBS0ksTUFBUUosS0FBS0ksTUFBTUYsS0FBS0YsSUFBSSxFQUNqQ0EsS0FBS0ssTUFBUUwsS0FBS0ssTUFBTUgsS0FBS0YsSUFBSSxFQUNqQ0EsS0FBS00sS0FBT04sS0FBS00sS0FBS0osS0FBS0YsSUFBSSxFQUMvQkEsS0FBS08sUUFBVVAsS0FBS08sUUFBUUwsS0FBS0YsSUFBSSxDQUN6QyxDQUVRRyxXQUErQkssR0FDbkMsSUFBSSxFQUFBcEIsT0FBQXFCLFNBQVFULEtBQUtQLE9BQU8sRUFBRWlCLElBQUlGLENBQUcsRUFDN0IsTUFBTSxJQUFJbEIsUUFBQXFCLHFCQUFxQkgsQ0FBRyxFQUV0Q1IsS0FBS1AsUUFBVSxDQUFFLEdBQUdPLEtBQUtQLFNBQVUsSUFBSWUsR0FBUUEsQ0FBRyxDQUN0RCxDQVdRUCxPQUNKTCxFQUdrQmdCLEtBQUFBLEVBQ2xCQyxHQUVBLE9BQWFELEtBQUFBLElBQVRoQixHQUErQixVQUFUaUIsRUFDZixJQUFJdEIsY0FDUFMsS0FBS1IsTUFDTFEsS0FBS04sU0FDTE0sS0FBS1AsT0FBTyxFQUdoQkcsR0FBaUIsWUFBVGlCLEdBT1JqQixHQUFpQixTQUFUaUIsRUFDRCxJQUFJdEIsY0FJUEssRUFDQUksS0FBS04sU0FDTE0sS0FBS1AsT0FBTyxFQVBwQixLQUFBLENBVUosQ0FFT0csS0FBdUJULEdBRTFCLE9BREFhLEtBQUtSLE1BQVdRLEtBQUtSLE1BQVIsSUFBaUJMLEVBQ3ZCYSxJQUNYLENBRU9JLE1BQTBCSSxHQUc3QixPQUZBUixLQUFLRyxXQUFXSyxDQUFHLEVBQ25CUixLQUFLUixNQUFXUSxLQUFLUixNQUFSLEtBQWtCZ0IsRUFDeEJSLElBSVgsQ0FFUU0sS0FBdUJQLEdBQzNCLE1BQU1ILEdBQU8sRUFBQVIsT0FBQTBCLFNBQVFkLEtBQUtSLEtBQUssRUFBRXVCLFdBQVcsSUFBS2hCLENBQU0sRUFDdkQsTUFBTyxDQUNISCxLQUFBQSxFQUNBSyxPQUFRQSxJQUFNRCxLQUFLQyxPQUFPTCxFQUFNLE1BQU0sQ0FOOUMsQ0FRQSxDQUVRVyxRQUNKUyxFQUNBbkIsR0FFQSxNQUFNRCxHQUFPLEVBQUFSLE9BQUEwQixTQUFRZCxLQUFLUixLQUFLLEVBQUV5QixpQkFDN0IsRUFBQTdCLE9BQUFxQixTQUFRTyxDQUFhLEVBQUVFLFVBQVUsQ0FDN0IsR0FBR2xCLEtBQUtOLFNBQ1IsR0FBR0csQ0FWVixDQVdJLENBQUMsRUFFTixNQUFPLENBQ0hELEtBQUFBLEVBQ0FLLE9BQVFBLElBQU1ELEtBQUtDLE9BQU9MLEVBQU0sU0FBUyxDQU5yQyxDQVFaLENBRU9TLFFBQ0gsTUFBTyxDQUNIVCxLQUFNSSxLQUFLUixNQUNYUyxPQUFRQSxJQUFNRCxLQUFLQyxPQUFPVyxLQUFBQSxFQUFXLE9BQU8sRUFDNUNOLEtBQU1OLEtBQUtNLEtBQ1hDLFFBQVNQLEtBQUtPLE9BTFYsQ0FPWixDRHZESixDQzBEU3JCLFFBQUFLLGNBQUFBIiwiZmlsZSI6IlVybFNlcmlhbGl6ZXIvVXJsU2VyaWFsaXplci5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5VcmxTZXJpYWxpemVyID0gdm9pZCAwO1xuY29uc3QgQmFzZV8xID0gcmVxdWlyZShcIi4uL0Jhc2VcIik7XG5jb25zdCB1dGlsc18xID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5jbGFzcyBVcmxTZXJpYWxpemVyIHtcbiAgICBfcGF0aDtcbiAgICBfcGFyYW1zO1xuICAgIF9vcHRpb25zO1xuICAgIGNvbnN0cnVjdG9yKHBhdGgsIG9wdGlvbnMgPSB1dGlsc18xLmRlZmF1bHRTZXJpYWxpemVPcHRpb25zLCBwYXJhbXMgPSB7fSkge1xuICAgICAgICB0aGlzLl9wYXRoID0gcGF0aDtcbiAgICAgICAgdGhpcy5fcGFyYW1zID0gcGFyYW1zO1xuICAgICAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgdGhpcy5leHRlbmQgPSB0aGlzLmV4dGVuZC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnNldHVwUGFyYW0gPSB0aGlzLnNldHVwUGFyYW0uYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5wYXRoID0gdGhpcy5wYXRoLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMucGFyYW0gPSB0aGlzLnBhcmFtLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuYnVpbGQgPSB0aGlzLmJ1aWxkLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMubGluayA9IHRoaXMubGluay5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnF1ZXJpZXMgPSB0aGlzLnF1ZXJpZXMuYmluZCh0aGlzKTtcbiAgICB9XG4gICAgc2V0dXBQYXJhbShrZXkpIHtcbiAgICAgICAgaWYgKCgwLCBCYXNlXzEuJE9iamVjdCkodGhpcy5fcGFyYW1zKS5nZXQoa2V5KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IHV0aWxzXzEuVW5pcXVlUGFyYW1FeGNlcHRpb24oa2V5KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wYXJhbXMgPSB7IC4uLnRoaXMuX3BhcmFtcywgW2A6JHtrZXl9YF06IGtleSB9O1xuICAgIH1cbiAgICBleHRlbmQocGF0aCA9IHVuZGVmaW5lZCwgdHlwZSkge1xuICAgICAgICBpZiAocGF0aCA9PT0gdW5kZWZpbmVkICYmIHR5cGUgPT09ICdidWlsZCcpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVXJsU2VyaWFsaXplcih0aGlzLl9wYXRoLCB0aGlzLl9vcHRpb25zLCB0aGlzLl9wYXJhbXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXRoICYmIHR5cGUgPT09ICdxdWVyaWVzJykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBVcmxTZXJpYWxpemVyKHBhdGgsIHRoaXMuX29wdGlvbnMsIHRoaXMuX3BhcmFtcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhdGggJiYgdHlwZSA9PT0gJ2xpbmsnKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFVybFNlcmlhbGl6ZXIocGF0aCwgdGhpcy5fb3B0aW9ucywgdGhpcy5fcGFyYW1zKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwYXRoKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3BhdGggPSBgJHt0aGlzLl9wYXRofS8ke3ZhbHVlfWA7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBwYXJhbShrZXkpIHtcbiAgICAgICAgdGhpcy5zZXR1cFBhcmFtKGtleSk7XG4gICAgICAgIHRoaXMuX3BhdGggPSBgJHt0aGlzLl9wYXRofS86JHtrZXl9YDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGxpbmsocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHBhdGggPSAoMCwgQmFzZV8xLiRTdHJpbmcpKHRoaXMuX3BhdGgpLnJlcGxhY2VBbGwoJy8nLCBwYXJhbXMpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcGF0aCxcbiAgICAgICAgICAgIGV4dGVuZDogKCkgPT4gdGhpcy5leHRlbmQocGF0aCwgJ2xpbmsnKSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcXVlcmllcyhxdWVyaWVzT2JqZWN0LCBvcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IHBhdGggPSAoMCwgQmFzZV8xLiRTdHJpbmcpKHRoaXMuX3BhdGgpLmpvaW5RdWVyeVN0cmluZygoMCwgQmFzZV8xLiRPYmplY3QpKHF1ZXJpZXNPYmplY3QpLnRvUXVlcmllcyh7XG4gICAgICAgICAgICAuLi50aGlzLl9vcHRpb25zLFxuICAgICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcGF0aCxcbiAgICAgICAgICAgIGV4dGVuZDogKCkgPT4gdGhpcy5leHRlbmQocGF0aCwgJ3F1ZXJpZXMnKSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgYnVpbGQoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwYXRoOiB0aGlzLl9wYXRoLFxuICAgICAgICAgICAgZXh0ZW5kOiAoKSA9PiB0aGlzLmV4dGVuZCh1bmRlZmluZWQsICdidWlsZCcpLFxuICAgICAgICAgICAgbGluazogdGhpcy5saW5rLFxuICAgICAgICAgICAgcXVlcmllczogdGhpcy5xdWVyaWVzLFxuICAgICAgICB9O1xuICAgIH1cbn1cbmV4cG9ydHMuVXJsU2VyaWFsaXplciA9IFVybFNlcmlhbGl6ZXI7XG4iLCJpbXBvcnQgeyAkT2JqZWN0LCAkU3RyaW5nLCBUeXBlcyB9IGZyb20gJy4uL0Jhc2UnXG5pbXBvcnQge1xuICAgIGRlZmF1bHRTZXJpYWxpemVPcHRpb25zLFxuICAgIFVybFNlcmlhbGl6ZXJPcHRpb25zLFxuICAgIFVybFNlcmlhbGl6ZXJQYXJhbXMsXG4gICAgVXJsU2VyaWFsaXplclF1ZXJpZXMsXG4gICAgVW5pcXVlUGFyYW1FeGNlcHRpb24sXG59IGZyb20gJy4vdXRpbHMnXG5cbmNsYXNzIFVybFNlcmlhbGl6ZXI8XG4gICAgUGF0aCBleHRlbmRzIHN0cmluZyxcbiAgICBQYXJhbXMgZXh0ZW5kcyBVcmxTZXJpYWxpemVyUGFyYW1zPHN0cmluZz5cbj4ge1xuICAgIHByaXZhdGUgX3BhdGg6IFBhdGhcbiAgICBwcml2YXRlIF9wYXJhbXM6IFBhcmFtc1xuICAgIHByaXZhdGUgX29wdGlvbnM6IFBhcnRpYWw8VXJsU2VyaWFsaXplck9wdGlvbnM+XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHBhdGg6IFBhdGgsXG4gICAgICAgIG9wdGlvbnM6IFBhcnRpYWw8VXJsU2VyaWFsaXplck9wdGlvbnM+ID0gZGVmYXVsdFNlcmlhbGl6ZU9wdGlvbnMsXG4gICAgICAgIHBhcmFtczogUGFyYW1zID0ge30gYXMgUGFyYW1zXG4gICAgKSB7XG4gICAgICAgIHRoaXMuX3BhdGggPSBwYXRoXG4gICAgICAgIHRoaXMuX3BhcmFtcyA9IHBhcmFtc1xuICAgICAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9uc1xuICAgICAgICB0aGlzLmV4dGVuZCA9IHRoaXMuZXh0ZW5kLmJpbmQodGhpcylcbiAgICAgICAgdGhpcy5zZXR1cFBhcmFtID0gdGhpcy5zZXR1cFBhcmFtLmJpbmQodGhpcylcbiAgICAgICAgdGhpcy5wYXRoID0gdGhpcy5wYXRoLmJpbmQodGhpcylcbiAgICAgICAgdGhpcy5wYXJhbSA9IHRoaXMucGFyYW0uYmluZCh0aGlzKVxuICAgICAgICB0aGlzLmJ1aWxkID0gdGhpcy5idWlsZC5iaW5kKHRoaXMpXG4gICAgICAgIHRoaXMubGluayA9IHRoaXMubGluay5iaW5kKHRoaXMpXG4gICAgICAgIHRoaXMucXVlcmllcyA9IHRoaXMucXVlcmllcy5iaW5kKHRoaXMpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXR1cFBhcmFtPEtleSBleHRlbmRzIHN0cmluZz4oa2V5OiBLZXkpIHtcbiAgICAgICAgaWYgKCRPYmplY3QodGhpcy5fcGFyYW1zKS5nZXQoa2V5KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFVuaXF1ZVBhcmFtRXhjZXB0aW9uKGtleSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wYXJhbXMgPSB7IC4uLnRoaXMuX3BhcmFtcywgW2A6JHtrZXl9YF06IGtleSB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBleHRlbmQocGF0aDogdW5kZWZpbmVkLCB0eXBlOiAnYnVpbGQnKTogVXJsU2VyaWFsaXplcjxQYXRoLCBQYXJhbXM+XG4gICAgcHJpdmF0ZSBleHRlbmQ8UCBleHRlbmRzIGAke3N0cmluZ30ke3N0cmluZ31gPihcbiAgICAgICAgcGF0aDogUCxcbiAgICAgICAgdHlwZTogJ3F1ZXJpZXMnXG4gICAgKTogVXJsU2VyaWFsaXplcjxQLCBQYXJhbXM+XG4gICAgcHJpdmF0ZSBleHRlbmQ8UCBleHRlbmRzIFBhcmFtcz4oXG4gICAgICAgIHBhdGg6IFR5cGVzLlN0cmluZy5SZXBsYWNlQWxsPFBhdGgsIFA+LFxuICAgICAgICB0eXBlOiAnbGluaydcbiAgICApOiBVcmxTZXJpYWxpemVyPFR5cGVzLlN0cmluZy5SZXBsYWNlQWxsPFBhdGgsIFA+LCBPbWl0PFBhcmFtcywga2V5b2YgUD4+XG4gICAgcHJpdmF0ZSBleHRlbmQ8UCBleHRlbmRzIFBhcmFtcz4oXG4gICAgICAgIHBhdGg6XG4gICAgICAgICAgICB8IFR5cGVzLlN0cmluZy5SZXBsYWNlQWxsPFBhdGgsIFA+XG4gICAgICAgICAgICB8IGAke1BhdGh9PyR7c3RyaW5nfWBcbiAgICAgICAgICAgIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkLFxuICAgICAgICB0eXBlOiAnYnVpbGQnIHwgJ3F1ZXJpZXMnIHwgJ2xpbmsnXG4gICAgKSB7XG4gICAgICAgIGlmIChwYXRoID09PSB1bmRlZmluZWQgJiYgdHlwZSA9PT0gJ2J1aWxkJykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBVcmxTZXJpYWxpemVyPFBhdGgsIFBhcmFtcz4oXG4gICAgICAgICAgICAgICAgdGhpcy5fcGF0aCxcbiAgICAgICAgICAgICAgICB0aGlzLl9vcHRpb25zLFxuICAgICAgICAgICAgICAgIHRoaXMuX3BhcmFtc1xuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICAgIGlmIChwYXRoICYmIHR5cGUgPT09ICdxdWVyaWVzJykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBVcmxTZXJpYWxpemVyPGAke1BhdGh9PyR7c3RyaW5nfWAsIFBhcmFtcz4oXG4gICAgICAgICAgICAgICAgcGF0aCxcbiAgICAgICAgICAgICAgICB0aGlzLl9vcHRpb25zLFxuICAgICAgICAgICAgICAgIHRoaXMuX3BhcmFtc1xuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICAgIGlmIChwYXRoICYmIHR5cGUgPT09ICdsaW5rJykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBVcmxTZXJpYWxpemVyPFxuICAgICAgICAgICAgICAgIFR5cGVzLlN0cmluZy5SZXBsYWNlQWxsPFBhdGgsIFA+LFxuICAgICAgICAgICAgICAgIE9taXQ8UGFyYW1zLCBrZXlvZiBQPlxuICAgICAgICAgICAgPihcbiAgICAgICAgICAgICAgICBwYXRoIGFzIFR5cGVzLlN0cmluZy5SZXBsYWNlQWxsPFBhdGgsIFA+LFxuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMsXG4gICAgICAgICAgICAgICAgdGhpcy5fcGFyYW1zXG4gICAgICAgICAgICApXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgcGF0aDxUIGV4dGVuZHMgc3RyaW5nPih2YWx1ZTogVCkge1xuICAgICAgICB0aGlzLl9wYXRoID0gYCR7dGhpcy5fcGF0aH0vJHt2YWx1ZX1gIGFzIFBhdGhcbiAgICAgICAgcmV0dXJuIHRoaXMgYXMgdW5rbm93biBhcyBVcmxTZXJpYWxpemVyPGAke1BhdGh9LyR7VH1gLCBQYXJhbXM+XG4gICAgfVxuXG4gICAgcHVibGljIHBhcmFtPEtleSBleHRlbmRzIHN0cmluZz4oa2V5OiBLZXkpIHtcbiAgICAgICAgdGhpcy5zZXR1cFBhcmFtKGtleSlcbiAgICAgICAgdGhpcy5fcGF0aCA9IGAke3RoaXMuX3BhdGh9Lzoke2tleX1gIGFzIFBhdGhcbiAgICAgICAgcmV0dXJuIHRoaXMgYXMgdW5rbm93biBhcyBVcmxTZXJpYWxpemVyPFxuICAgICAgICAgICAgYCR7UGF0aH0vOiR7S2V5fWAsXG4gICAgICAgICAgICBQYXJhbXMgJiBVcmxTZXJpYWxpemVyUGFyYW1zPEtleT5cbiAgICAgICAgPlxuICAgIH1cblxuICAgIHByaXZhdGUgbGluazxQIGV4dGVuZHMgUGFyYW1zPihwYXJhbXM6IFApIHtcbiAgICAgICAgY29uc3QgcGF0aCA9ICRTdHJpbmcodGhpcy5fcGF0aCkucmVwbGFjZUFsbCgnLycsIHBhcmFtcylcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHBhdGgsXG4gICAgICAgICAgICBleHRlbmQ6ICgpID0+IHRoaXMuZXh0ZW5kKHBhdGgsICdsaW5rJyksXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHF1ZXJpZXM8UXVlcmllcyBleHRlbmRzIFVybFNlcmlhbGl6ZXJRdWVyaWVzPihcbiAgICAgICAgcXVlcmllc09iamVjdDogUXVlcmllcyxcbiAgICAgICAgb3B0aW9ucz86IFBhcnRpYWw8VXJsU2VyaWFsaXplck9wdGlvbnM+XG4gICAgKSB7XG4gICAgICAgIGNvbnN0IHBhdGggPSAkU3RyaW5nKHRoaXMuX3BhdGgpLmpvaW5RdWVyeVN0cmluZyhcbiAgICAgICAgICAgICRPYmplY3QocXVlcmllc09iamVjdCkudG9RdWVyaWVzKHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLl9vcHRpb25zLFxuICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgZXh0ZW5kOiAoKSA9PiB0aGlzLmV4dGVuZChwYXRoLCAncXVlcmllcycpLFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGJ1aWxkKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcGF0aDogdGhpcy5fcGF0aCxcbiAgICAgICAgICAgIGV4dGVuZDogKCkgPT4gdGhpcy5leHRlbmQodW5kZWZpbmVkLCAnYnVpbGQnKSxcbiAgICAgICAgICAgIGxpbms6IHRoaXMubGluayxcbiAgICAgICAgICAgIHF1ZXJpZXM6IHRoaXMucXVlcmllcyxcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgVXJsU2VyaWFsaXplciB9XG4iXX0=
