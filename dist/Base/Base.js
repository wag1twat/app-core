"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Base=void 0;const Guards_1=require("../Guards"),rules_1=require("./rules"),Types_1=require("./Types");var Base;!function(o){o.Object=function a(p){function d(e){return p[e]}return{get:d,toQueries:function(s=Types_1.Types.Object.defaultToQueriesOptions,r){var t,{skipNull:e,skipUndefined:u}=s;let n=[];for(t in p)if(p.hasOwnProperty(t)){var o,i,c=d(t);if(!(!0===e&&Guards_1.Guards.isNull(c)||!0===u&&Guards_1.Guards.isUndefined(c))){let e=t;Guards_1.Guards.isArrayConstructor(p)?([o,i]=Types_1.Types.Object.toQueriesAccsessors[s.arrayAccsessor||Types_1.Types.Object.defaultToQueriesOptions.arrayAccsessor],e=""+r+o+i):Guards_1.Guards.isObjectConstructor(p)&&([o,i]=Types_1.Types.Object.toQueriesAccsessors[s.objectAccsessor||Types_1.Types.Object.defaultToQueriesOptions.objectAccsessor],e=r?""+r+o+e+i:e),Guards_1.Guards.isTypeofObject(c)?n.push(a(c).toQueries(s,e)):n.push(e+"="+encodeURIComponent(""+c))}}return n=n.filter(rules_1.nonEmptyString),(n=[].concat.apply([],n)).length?n.join("&"):""}}},o.String=function(r){function s(){return-1!==(""+r).indexOf("?")}function n(e,s){return(""+r).split(e,s)}return{split:n,replaceAllSeparatedString:function(e,s){var r=[],t=n(e);for(let e=0;e<t.length;e++){var u=o.Object(s).get(t[e]);o.Object(s).get(t[e])?r.push(u):r.push(t[e])}return r.join(e)},hasQueryParams:s,joinQueryString:function(e){return s()?r+"&"+e:r+"?"+e}}}}(Base=Base||{}),exports.Base=Base;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJhc2UvQmFzZS5qcyIsIi4uL3NyYy9CYXNlL0Jhc2UudHMiXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJHdWFyZHNfMSIsInJlcXVpcmUiLCJydWxlc18xIiwiVHlwZXNfMSIsIkJhc2UiLCJvYmoiLCJnZXQiLCJrZXkiLCJ0b1F1ZXJpZXMiLCJvcHRpb25zIiwiVHlwZXMiLCJkZWZhdWx0VG9RdWVyaWVzT3B0aW9ucyIsInByZWZpeCIsInNraXBOdWxsIiwic2tpcFVuZGVmaW5lZCIsImxldCIsInJlc3VsdCIsImhhc093blByb3BlcnR5IiwicHJlIiwicG9zdCIsIkd1YXJkcyIsImlzTnVsbCIsImlzVW5kZWZpbmVkIiwiYWNjc2Vzc29yIiwiaXNBcnJheUNvbnN0cnVjdG9yIiwidG9RdWVyaWVzQWNjc2Vzc29ycyIsImFycmF5QWNjc2Vzc29yIiwiaXNPYmplY3RDb25zdHJ1Y3RvciIsIm9iamVjdEFjY3Nlc3NvciIsImlzVHlwZW9mT2JqZWN0IiwicHVzaCIsImVuY29kZVVSSUNvbXBvbmVudCIsImZpbHRlciIsIm5vbkVtcHR5U3RyaW5nIiwiY29uY2F0IiwiYXBwbHkiLCJsZW5ndGgiLCJqb2luIiwiU3RyaW5nIiwic3RyaW5nIiwiaGFzUXVlcnlQYXJhbXMiLCJpbmRleE9mIiwic3BsaXQiLCJzZXBhcmF0b3IiLCJsaW1pdCIsInJlcGxhY2VBbGxTZXBhcmF0ZWRTdHJpbmciLCJwcm9wZXJ0aWVzIiwicGFydHMiLCJpIiwicHJvcGVydHkiLCJqb2luUXVlcnlTdHJpbmciLCJxdWVyeVN0cmluZyJdLCJtYXBwaW5ncyI6IkFBQUEsYUFDQUEsT0FBT0MsZUFBZUMsUUFBUyxhQUFjLENBQUVDLE1BQU8sQ0FBQSxDQUFLLENBQUMsRUFBNURILFFBQU9DLEtBQUFBLEtBQUFBLEVDRFAsTUFBQUcsU0FBQUMsUUFBQSxXQUFBLEVBQ0FDLFFBQUFELFFBQUEsU0FBQSxFQUNBRSxRQUFBRixRQUFBLFNBQUEsRUFJQSxJQUFVRyxLQUFWLENBQUEsU0FBVUEsR0FDVUEsRUFBQVIsT0FBaEIsU0FBZ0JBLEVBQXlCUyxHQUNyQyxTQUFTQyxFQUFzQkMsR0FDM0IsT0FBT0YsRUFBSUUsRUFDZixDQWdEQSxNQUFPLENBQ0hELElBQUFBLEVBQ0FFLFVBaERKLFNBQW1CQyxFQUFrRE4sUUFBQU8sTUFBTWQsT0FBT2Usd0JBQXlCQyxHQUN2RyxJQUlRTCxFQUpGLENBQUVNLFNBQUFBLEVBQVVDLGNBQUFBLENBQWEsRUFBS0wsRUFFcENNLElBQUlDLEVBQW1CLEdBRXZCLElBQVFULEtBQU9GLEVBQ1gsR0FBR0EsRUFBSVksZUFBZVYsQ0FBRyxFQUF6QixDQUNJLElBZ0JXVyxFQUFLQyxFQWhCVnBCLEVBQVFPLEVBQUlDLENBQUcsRUFFckIsR0FBR00sRUFBYSxDQUFBLElBQWJBLEdBQXFCYixTQUFBb0IsT0FBT0MsT0FBT3RCLENBQUssR0FHakIsQ0FBQSxJQUFsQmUsR0FBMEJkLFNBQUFvQixPQUFPRSxZQUFZdkIsQ0FBSyxHQUFyRCxDQUlMZ0IsSUFBSVEsRUFBb0JoQixFQUVyQlAsU0FBQW9CLE9BQU9JLG1CQUFtQm5CLENBQUcsR0FDdEIsQ0FBQ2EsRUFBS0MsR0FBUWhCLFFBQUFPLE1BQU1kLE9BQU82QixvQkFBb0JoQixFQUFRaUIsZ0JBQWtCdkIsUUFBQU8sTUFBTWQsT0FBT2Usd0JBQXdCZSxnQkFDcEhILEVBQVksR0FBR1gsRUFBU00sRUFBTUMsR0FFMUJuQixTQUFBb0IsT0FBT08sb0JBQW9CdEIsQ0FBRyxJQUM1QixDQUFDYSxFQUFLQyxHQUFRaEIsUUFBQU8sTUFBTWQsT0FBTzZCLG9CQUFvQmhCLEVBQVFtQixpQkFBbUJ6QixRQUFBTyxNQUFNZCxPQUFPZSx3QkFBd0JpQixpQkFDckhMLEVBQWFYLEVBQVMsR0FBR0EsRUFBU00sRUFBTUssRUFBWUosRUFBU0ksR0FHOUR2QixTQUFBb0IsT0FBT1MsZUFBZTlCLENBQUssRUFDMUJpQixFQUFPYyxLQUFLbEMsRUFBT0csQ0FBSyxFQUFFUyxVQUFVQyxFQUFTYyxDQUFTLENBQUMsRUFHdkRQLEVBQU9jLEtBQVFQLEVBQUgsSUFBZ0JRLG1CQUFtQixHQUFHaEMsQ0FBTyxDQUFHLENBeEIxREEsQ0EyQkwsQ0FTVCxPQUpBaUIsRUFBU0EsRUFBT2dCLE9BQU85QixRQUFBK0IsY0FBYyxHQUVyQ2pCLEVBQVUsR0FBZ0JrQixPQUFPQyxNQUFNLEdBQWdCbkIsQ0FBTSxHQUUvQ29CLE9BQVNwQixFQUFPcUIsS0FBSyxHQUFHLEVBQUksRUFDOUMsQ0FHSS9CLENBR1IsRUFFZ0JGLEVBQUFrQyxPQUFoQixTQUF5Q0MsR0FDckMsU0FBU0MsSUFDTCxNQUFvQyxDQUFDLEtBQTlCLEdBQUdELEdBQVNFLFFBQVEsR0FBRyxDQUNsQyxDQU9BLFNBQVNDLEVBQWdDQyxFQUFtQkMsR0FDeEQsT0FBTyxHQUFHTCxHQUFTRyxNQUFNQyxFQUFXQyxDQUFLLENBQzdDLENBcUJBLE1BQU8sQ0FDSEYsTUFBQUEsRUFDQUcsMEJBckJKLFNBQ0NGLEVBQXNCRyxHQUNuQixJQUFNOUIsRUFBUyxHQUVUK0IsRUFBUUwsRUFBTUMsQ0FBUyxFQUU3QixJQUFJNUIsSUFBSWlDLEVBQUksRUFBR0EsRUFBSUQsRUFBTVgsT0FBUVksQ0FBQyxHQUFJLENBQ2xDLElBQU1DLEVBQVc3QyxFQUFLUixPQUFVa0QsQ0FBVSxFQUFFeEMsSUFBSXlDLEVBQU1DLEVBQUUsRUFFckQ1QyxFQUFLUixPQUFVa0QsQ0FBVSxFQUFFeEMsSUFBSXlDLEVBQU1DLEVBQUUsRUFDdENoQyxFQUFPYyxLQUFLbUIsQ0FBUSxFQUVwQmpDLEVBQU9jLEtBQUtpQixFQUFNQyxFQUFFLENEZnhCLENDbUJKLE9BQU9oQyxFQUFPcUIsS0FBS00sQ0FBUyxDQUNoQyxFQUtJSCxlQUFBQSxFQUNBVSxnQkFoQ0osU0FBMkNDLEdBRXZDLE9BRHlCWCxFQUFjLEVBQ1ZELEVBQUgsSUFBYVksRUFBbUJaLEVBQUgsSUFBYVksQ0FDeEUsQ0E2QklELENBRVIsQ0FDSCxFQWxHUzlDLEtBQUFBLE1BQUksRUFBQSxFQW9HTE4sUUFBQU0sS0FBQUEiLCJmaWxlIjoiQmFzZS9CYXNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkJhc2UgPSB2b2lkIDA7XG5jb25zdCBHdWFyZHNfMSA9IHJlcXVpcmUoXCIuLi9HdWFyZHNcIik7XG5jb25zdCBydWxlc18xID0gcmVxdWlyZShcIi4vcnVsZXNcIik7XG5jb25zdCBUeXBlc18xID0gcmVxdWlyZShcIi4vVHlwZXNcIik7XG52YXIgQmFzZTtcbihmdW5jdGlvbiAoQmFzZSkge1xuICAgIGZ1bmN0aW9uIE9iamVjdChvYmopIHtcbiAgICAgICAgZnVuY3Rpb24gZ2V0KGtleSkge1xuICAgICAgICAgICAgcmV0dXJuIG9ialtrZXldO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHRvUXVlcmllcyhvcHRpb25zID0gVHlwZXNfMS5UeXBlcy5PYmplY3QuZGVmYXVsdFRvUXVlcmllc09wdGlvbnMsIHByZWZpeCkge1xuICAgICAgICAgICAgY29uc3QgeyBza2lwTnVsbCwgc2tpcFVuZGVmaW5lZCB9ID0gb3B0aW9ucztcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBnZXQoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNraXBOdWxsID09PSB0cnVlICYmIEd1YXJkc18xLkd1YXJkcy5pc051bGwodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChza2lwVW5kZWZpbmVkID09PSB0cnVlICYmIEd1YXJkc18xLkd1YXJkcy5pc1VuZGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBhY2NzZXNzb3IgPSBrZXk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChHdWFyZHNfMS5HdWFyZHMuaXNBcnJheUNvbnN0cnVjdG9yKG9iaikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFtwcmUsIHBvc3RdID0gVHlwZXNfMS5UeXBlcy5PYmplY3QudG9RdWVyaWVzQWNjc2Vzc29yc1tvcHRpb25zLmFycmF5QWNjc2Vzc29yIHx8IFR5cGVzXzEuVHlwZXMuT2JqZWN0LmRlZmF1bHRUb1F1ZXJpZXNPcHRpb25zLmFycmF5QWNjc2Vzc29yXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY3Nlc3NvciA9IGAke3ByZWZpeH0ke3ByZX0ke3Bvc3R9YDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChHdWFyZHNfMS5HdWFyZHMuaXNPYmplY3RDb25zdHJ1Y3RvcihvYmopKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBbcHJlLCBwb3N0XSA9IFR5cGVzXzEuVHlwZXMuT2JqZWN0LnRvUXVlcmllc0FjY3Nlc3NvcnNbb3B0aW9ucy5vYmplY3RBY2NzZXNzb3IgfHwgVHlwZXNfMS5UeXBlcy5PYmplY3QuZGVmYXVsdFRvUXVlcmllc09wdGlvbnMub2JqZWN0QWNjc2Vzc29yXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY3Nlc3NvciA9IChwcmVmaXggPyBgJHtwcmVmaXh9JHtwcmV9JHthY2NzZXNzb3J9JHtwb3N0fWAgOiBhY2NzZXNzb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChHdWFyZHNfMS5HdWFyZHMuaXNUeXBlb2ZPYmplY3QodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChPYmplY3QodmFsdWUpLnRvUXVlcmllcyhvcHRpb25zLCBhY2NzZXNzb3IpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGAke2FjY3Nlc3Nvcn09JHtlbmNvZGVVUklDb21wb25lbnQoYCR7dmFsdWV9YCl9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5maWx0ZXIocnVsZXNfMS5ub25FbXB0eVN0cmluZyk7XG4gICAgICAgICAgICByZXN1bHQgPSBbXS5jb25jYXQuYXBwbHkoW10sIHJlc3VsdCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA/IHJlc3VsdC5qb2luKCcmJykgOiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXQsXG4gICAgICAgICAgICB0b1F1ZXJpZXNcbiAgICAgICAgfTtcbiAgICB9XG4gICAgQmFzZS5PYmplY3QgPSBPYmplY3Q7XG4gICAgZnVuY3Rpb24gU3RyaW5nKHN0cmluZykge1xuICAgICAgICBmdW5jdGlvbiBoYXNRdWVyeVBhcmFtcygpIHtcbiAgICAgICAgICAgIHJldHVybiBgJHtzdHJpbmd9YC5pbmRleE9mKCc/JykgIT09IC0xO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGpvaW5RdWVyeVN0cmluZyhxdWVyeVN0cmluZykge1xuICAgICAgICAgICAgY29uc3QgaXNIYXNRdWVyeVBhcmFtcyA9IGhhc1F1ZXJ5UGFyYW1zKCk7XG4gICAgICAgICAgICByZXR1cm4gaXNIYXNRdWVyeVBhcmFtcyA/IGAke3N0cmluZ30mJHtxdWVyeVN0cmluZ31gIDogYCR7c3RyaW5nfT8ke3F1ZXJ5U3RyaW5nfWA7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc3BsaXQoc2VwYXJhdG9yLCBsaW1pdCkge1xuICAgICAgICAgICAgcmV0dXJuIGAke3N0cmluZ31gLnNwbGl0KHNlcGFyYXRvciwgbGltaXQpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlcGxhY2VBbGxTZXBhcmF0ZWRTdHJpbmcoc2VwYXJhdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gc3BsaXQoc2VwYXJhdG9yKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IEJhc2UuT2JqZWN0KHByb3BlcnRpZXMpLmdldChwYXJ0c1tpXSk7XG4gICAgICAgICAgICAgICAgaWYgKEJhc2UuT2JqZWN0KHByb3BlcnRpZXMpLmdldChwYXJ0c1tpXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocHJvcGVydHkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocGFydHNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQuam9pbihzZXBhcmF0b3IpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzcGxpdCxcbiAgICAgICAgICAgIHJlcGxhY2VBbGxTZXBhcmF0ZWRTdHJpbmcsXG4gICAgICAgICAgICBoYXNRdWVyeVBhcmFtcyxcbiAgICAgICAgICAgIGpvaW5RdWVyeVN0cmluZ1xuICAgICAgICB9O1xuICAgIH1cbiAgICBCYXNlLlN0cmluZyA9IFN0cmluZztcbn0pKEJhc2UgfHwgKEJhc2UgPSB7fSkpO1xuZXhwb3J0cy5CYXNlID0gQmFzZTtcbiIsImltcG9ydCB7IEd1YXJkcyB9IGZyb20gXCIuLi9HdWFyZHNcIlxyXG5pbXBvcnQgeyBub25FbXB0eVN0cmluZyB9IGZyb20gJy4vcnVsZXMnXHJcbmltcG9ydCB7IFR5cGVzIH0gZnJvbSBcIi4vVHlwZXNcIlxyXG5cclxuXHJcblxyXG5uYW1lc3BhY2UgQmFzZSB7XHJcbiAgICBleHBvcnQgZnVuY3Rpb24gT2JqZWN0PE8gZXh0ZW5kcyBvYmplY3Q+KG9iajogTykge1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldDxLIGV4dGVuZHMgc3RyaW5nPihrZXk6IEsgfCBrZXlvZiBPKXtcclxuICAgICAgICAgICAgcmV0dXJuIG9ialtrZXkgYXMgRXhjbHVkZTx0eXBlb2Yga2V5LCBLPl1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHRvUXVlcmllcyhvcHRpb25zOiBQYXJ0aWFsPFR5cGVzLk9iamVjdC5Ub1F1ZXJpZXNPcHRpb25zPiA9IFR5cGVzLk9iamVjdC5kZWZhdWx0VG9RdWVyaWVzT3B0aW9ucywgcHJlZml4Pzogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICAgICAgY29uc3QgeyBza2lwTnVsbCwgc2tpcFVuZGVmaW5lZCB9ID0gb3B0aW9uc1xyXG5cclxuICAgICAgICAgICAgbGV0IHJlc3VsdDogc3RyaW5nW10gPSBbXVxyXG5cclxuICAgICAgICAgICAgZm9yKGxldCBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgICAgICAgICBpZihvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZ2V0KGtleSlcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc2tpcE51bGwgPT09IHRydWUgJiYgR3VhcmRzLmlzTnVsbCh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihza2lwVW5kZWZpbmVkID09PSB0cnVlICYmIEd1YXJkcy5pc1VuZGVmaW5lZCh2YWx1ZSkpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFjY3Nlc3Nvcjogc3RyaW5nID0ga2V5XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKEd1YXJkcy5pc0FycmF5Q29uc3RydWN0b3Iob2JqKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBbcHJlLCBwb3N0XSA9IFR5cGVzLk9iamVjdC50b1F1ZXJpZXNBY2NzZXNzb3JzW29wdGlvbnMuYXJyYXlBY2NzZXNzb3IgfHwgVHlwZXMuT2JqZWN0LmRlZmF1bHRUb1F1ZXJpZXNPcHRpb25zLmFycmF5QWNjc2Vzc29yXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NzZXNzb3IgPSBgJHtwcmVmaXh9JHtwcmV9JHtwb3N0fWBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihHdWFyZHMuaXNPYmplY3RDb25zdHJ1Y3RvcihvYmopKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFtwcmUsIHBvc3RdID0gVHlwZXMuT2JqZWN0LnRvUXVlcmllc0FjY3Nlc3NvcnNbb3B0aW9ucy5vYmplY3RBY2NzZXNzb3IgfHwgVHlwZXMuT2JqZWN0LmRlZmF1bHRUb1F1ZXJpZXNPcHRpb25zLm9iamVjdEFjY3Nlc3Nvcl1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjc2Vzc29yID0gKHByZWZpeCA/IGAke3ByZWZpeH0ke3ByZX0ke2FjY3Nlc3Nvcn0ke3Bvc3R9YCA6IGFjY3Nlc3Nvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoR3VhcmRzLmlzVHlwZW9mT2JqZWN0KHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChPYmplY3QodmFsdWUpLnRvUXVlcmllcyhvcHRpb25zLCBhY2NzZXNzb3IpKSBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGAke2FjY3Nlc3Nvcn09JHtlbmNvZGVVUklDb21wb25lbnQoYCR7dmFsdWV9YCl9YClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmZpbHRlcihub25FbXB0eVN0cmluZylcclxuXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IChbXSBhcyBzdHJpbmdbXSkuY29uY2F0LmFwcGx5KFtdIGFzIHN0cmluZ1tdLCByZXN1bHQpXHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA/IHJlc3VsdC5qb2luKCcmJykgOiBcIlwiXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBnZXQsXHJcbiAgICAgICAgICAgIHRvUXVlcmllc1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBleHBvcnQgZnVuY3Rpb24gU3RyaW5nPFMgZXh0ZW5kcyBzdHJpbmc+KHN0cmluZzogUykge1xyXG4gICAgICAgIGZ1bmN0aW9uIGhhc1F1ZXJ5UGFyYW1zKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYCR7c3RyaW5nfWAuaW5kZXhPZignPycpICE9PSAtMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGpvaW5RdWVyeVN0cmluZzxRIGV4dGVuZHMgc3RyaW5nPihxdWVyeVN0cmluZzogUSk6IFMgZXh0ZW5kcyBgJHtzdHJpbmd9PyR7c3RyaW5nfWAgPyBgJHtTfSYke1F9YCA6IGAke1N9PyR7UX1gIHtcclxuICAgICAgICAgICAgY29uc3QgaXNIYXNRdWVyeVBhcmFtcyA9IGhhc1F1ZXJ5UGFyYW1zKClcclxuICAgICAgICAgICAgcmV0dXJuIGlzSGFzUXVlcnlQYXJhbXMgPyBgJHtzdHJpbmd9JiR7cXVlcnlTdHJpbmd9YCA6IGAke3N0cmluZ30/JHtxdWVyeVN0cmluZ31gIGFzIGFueVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc3BsaXQ8U2VwYXJhdG9yIGV4dGVuZHMgc3RyaW5nPihzZXBhcmF0b3I6IHN0cmluZywgbGltaXQ/OiBudW1iZXIgfCB1bmRlZmluZWQpOiBUeXBlcy5TdHJpbmcuU3BsaXQ8UywgU2VwYXJhdG9yPiB7XHJcbiAgICAgICAgICAgIHJldHVybiBgJHtzdHJpbmd9YC5zcGxpdChzZXBhcmF0b3IsIGxpbWl0KSBhcyBhbnlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlcGxhY2VBbGxTZXBhcmF0ZWRTdHJpbmc8UCBleHRlbmRzIHsgW3g6IHN0cmluZ106IGFueSB9LCBTZXBhcmF0b3IgZXh0ZW5kcyBzdHJpbmcgPSBzdHJpbmc+XHJcbiAgICAgICAgKHNlcGFyYXRvcjogU2VwYXJhdG9yLCBwcm9wZXJ0aWVzOiBQKTogVHlwZXMuU3RyaW5nLlJlcGxhY2VBbGw8UywgUD4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBbXVxyXG5cclxuICAgICAgICAgICAgY29uc3QgcGFydHMgPSBzcGxpdChzZXBhcmF0b3IpXHJcblxyXG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5ID0gQmFzZS5PYmplY3Q8UD4ocHJvcGVydGllcykuZ2V0KHBhcnRzW2ldKVxyXG5cclxuICAgICAgICAgICAgICAgIGlmKEJhc2UuT2JqZWN0PFA+KHByb3BlcnRpZXMpLmdldChwYXJ0c1tpXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChwcm9wZXJ0eSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocGFydHNbaV0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQuam9pbihzZXBhcmF0b3IpIGFzIFR5cGVzLlN0cmluZy5SZXBsYWNlQWxsPFMsIFA+XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNwbGl0LFxyXG4gICAgICAgICAgICByZXBsYWNlQWxsU2VwYXJhdGVkU3RyaW5nLFxyXG4gICAgICAgICAgICBoYXNRdWVyeVBhcmFtcyxcclxuICAgICAgICAgICAgam9pblF1ZXJ5U3RyaW5nXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBCYXNlIH0iXX0=
