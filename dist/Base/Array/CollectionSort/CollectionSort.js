"use strict";var __importDefault=function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.collectionSort=void 0;const Guards_1=require("../../../Guards"),get_xpath_1=__importDefault(require("../../Object/get-xpath")),get_compare_function_1=__importDefault(require("./get-compare-function"));class CollectionSort{defaultOrder="ASC";defaultOrders=["ASC","DESC","default"];state;setState;getDefaultCollection;cleanup;haveBeenInitialize=!1;constructor(t,e){const{onSortUpdate:i,field:s,order:a=this.defaultOrder,orders:r=this.defaultOrders,onMount:l}=e;this.state={collection:t,order:a,orders:r,field:s},this.cleanup=()=>{},this.cleanup=this.cleanup.bind(this),this.getDefaultCollection=()=>t,this.getDefaultCollection=this.getDefaultCollection.bind(this),this.setState=function(t){this.state={...this.state,...t},Guards_1.Guards.isFunc(i)&&i(this.state)},this.setState=this.setState.bind(this),this.getValue=this.getValue.bind(this),this.update=this.update.bind(this),this.setField=this.setField.bind(this),this.setOrder=this.setOrder.bind(this),Guards_1.Guards.isBoolean(l)?l&&!this.haveBeenInitialize&&(this.update(),this.haveBeenInitialize=!0):this.haveBeenInitialize||(this.update(),this.haveBeenInitialize=!0)}setField=t=>{Guards_1.Guards.isUndefined(t)||this.setState({field:t})};setOrder=()=>{var t,e;this.haveBeenInitialize&&(t=this.state.orders.length-1,e=this.state.orders.indexOf(this.state.order)+1,this.setState({order:e<=t?this.state.orders[e]:this.state.orders[0]}))};getValue(t){return Guards_1.Guards.isString(this.state.field)?(0,get_xpath_1.default)(t)(this.state.field):Guards_1.Guards.isObject(this.state.field)?this.state.field.handler((0,get_xpath_1.default)(t)(this.state.field.xpath)):t}update(t={}){t=t.field;this.setOrder(),this.setField(t),"default"===this.state.order?this.setState({collection:this.getDefaultCollection().slice()}):this.setState({collection:this.state.collection.slice().sort((t,e)=>(0,get_compare_function_1.default)(this.state.order,this.getValue(t),this.getValue(e)))})}}const collectionSort=(t,e)=>new CollectionSort(t,e);exports.collectionSort=collectionSort;
//# sourceMappingURL=CollectionSort.js.map
