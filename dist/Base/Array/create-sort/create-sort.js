"use strict";var __importDefault=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSort=void 0;const Types_1=require("../../Types"),Guards_1=require("../../../Guards"),get_xpath_1=__importDefault(require("../../Object/get-xpath")),get_compare_function_1=__importDefault(require("./get-compare-function")),createSort=f=>e=>{let t=!1;const{field:r,order:d,orders:s,onMount:a=!0,onSortUpdate:i}=e,o={collection:f.slice(),order:d||Types_1.Types.Array.Sort.defaultOrder,orders:s||Types_1.Types.Array.Sort.defaultOrders,field:r||void 0},u=()=>{Guards_1.Guards.isFunc(i)&&i(o)},l=e=>Guards_1.Guards.isString(o.field)?(0,get_xpath_1.default)(e)(o.field):Guards_1.Guards.isObject(o.field)?o.field.handler((0,get_xpath_1.default)(e)(o.field.xpath)):e;const _=e=>{Guards_1.Guards.isUndefined(e)||(o.field=e)},c=(e,r)=>{let d=!1;r?Guards_1.Guards.isString(o.field)&&Guards_1.Guards.isString(e)?o.field===e&&(d=t):Guards_1.Guards.isString(o.field)&&Guards_1.Guards.isObject(e)?o.field===e.xpath&&(d=t):Guards_1.Guards.isObject(o.field)&&Guards_1.Guards.isString(e)?o.field.xpath===e&&(d=t):Guards_1.Guards.isObject(o.field)&&Guards_1.Guards.isObject(e)&&o.field.xpath===e.xpath&&(d=t):d=t,d&&(r=o.orders.length-1,e=o.orders.indexOf(o.order)+1,o.order=e<=r?o.orders[e]:o.orders[0])};e=(e={})=>{var{field:e,noUpdateOrderFalsyEqualXPath:r=!1}=e;c(e,r),_(e),"default"===o.order?o.collection=f.slice():o.collection=o.collection.slice().sort((e,r)=>(0,get_compare_function_1.default)(o.order,l(e),l(r))),u()};return!t&&a&&(e({field:r}),t=!0),{cleanup:()=>{o.field=r||void 0,o.order=d||Types_1.Types.Array.Sort.defaultOrder,o.orders=s||Types_1.Types.Array.Sort.defaultOrders,o.collection=f.slice(),u()},update:e}};exports.createSort=createSort;
//# sourceMappingURL=create-sort.js.map
