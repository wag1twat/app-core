"use strict";var __importDefault=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSort=void 0;const Types_1=require("../../Types"),Guards_1=require("../../../Guards"),get_xpath_1=__importDefault(require("../../Object/get-xpath")),get_compare_function_1=__importDefault(require("./get-compare-function")),createSort=c=>e=>{let t=!1;const{field:r,order:d,orders:s,onUpdate:a}=e,i={collection:c.slice(),order:d||Types_1.Types.Array.Sort.defaultOrder,orders:s||Types_1.Types.Array.Sort.defaultOrders,field:r||void 0},o=()=>{Guards_1.Guards.isFunc(a)&&a(i)},u=e=>Guards_1.Guards.isString(i.field)?(0,get_xpath_1.default)(e)(i.field):Guards_1.Guards.isObject(i.field)?i.field.handler((0,get_xpath_1.default)(e)(i.field.xpath)):e;const l=e=>{Guards_1.Guards.isUndefined(e)||(i.field=e)},_=(e,r)=>{let d=!1;r?Guards_1.Guards.isString(i.field)&&Guards_1.Guards.isString(e)?i.field===e&&(d=t):Guards_1.Guards.isString(i.field)&&Guards_1.Guards.isObject(e)?i.field===e.xpath&&(d=t):Guards_1.Guards.isObject(i.field)&&Guards_1.Guards.isString(e)?i.field.xpath===e&&(d=t):Guards_1.Guards.isObject(i.field)&&Guards_1.Guards.isObject(e)&&i.field.xpath===e.xpath&&(d=t):d=t,d&&(r=i.orders.length-1,e=i.orders.indexOf(i.order)+1,i.order=e<=r?i.orders[e]:i.orders[0])};e=(e={})=>{var{field:e,noUpdateOrderFalsyEqualXPath:r=!1}=e;_(e,r),l(e),"default"===i.order?i.collection=c.slice():i.collection=i.collection.slice().sort((e,r)=>(0,get_compare_function_1.default)(i.order,u(e),u(r))),o()};return t||(e({field:r}),t=!0),{cleanup:()=>{i.field=r||void 0,i.order=d||Types_1.Types.Array.Sort.defaultOrder,i.orders=s||Types_1.Types.Array.Sort.defaultOrders,i.collection=c.slice(),o()},update:e}};exports.createSort=createSort;
//# sourceMappingURL=create-sort.js.map
